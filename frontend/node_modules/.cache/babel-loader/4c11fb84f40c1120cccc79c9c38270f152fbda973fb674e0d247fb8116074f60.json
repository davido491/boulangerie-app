{"ast":null,"code":"import{useState,useEffect,useMemo,useCallback}from'react';import axios from'axios';import{API_URL}from'../config';function useProductList(){const[products,setProducts]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[nameFilter,setNameFilter]=useState('');const[maxPriceFilter,setMaxPriceFilter]=useState('');const[sortOrder,setSortOrder]=useState('');const[deletingProductId,setDeletingProductId]=useState(null);const fetchProducts=useCallback(async()=>{try{setLoading(true);const response=await axios.get(\"\".concat(API_URL,\"/products\"));setProducts(response.data);setError(null);}catch(error){setError(error);}finally{setLoading(false);}},[]);useEffect(()=>{fetchProducts();},[fetchProducts]);const handleProductAdded=useCallback(newProduct=>{setProducts(prevProducts=>[...prevProducts,newProduct]);},[]);const handleDeleteProduct=async productId=>{try{setDeletingProductId(productId);await axios.delete(\"\".concat(API_URL,\"/products/\").concat(productId));setProducts(prevProducts=>prevProducts.filter(product=>product._id!==productId));}catch(error){var _error$response,_error$response$data;setError(\"Erreur lors de la suppression : \".concat(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||error.message));}finally{setDeletingProductId(null);}};const handleMaxPriceChange=e=>{const value=e.target.value;if(value===''||!isNaN(parseFloat(value))&&isFinite(value)){setMaxPriceFilter(value);}};const filteredAndSortedProducts=useMemo(()=>{return products.filter(product=>product.name.toLowerCase().includes(nameFilter.toLowerCase())).filter(product=>maxPriceFilter===''||product.price<=parseFloat(maxPriceFilter)).sort((a,b)=>{if(sortOrder==='asc'){return a.price-b.price;}else if(sortOrder==='desc'){return b.price-a.price;}return 0;});},[products,nameFilter,maxPriceFilter,sortOrder]);return{loading,error,nameFilter,maxPriceFilter,sortOrder,filteredAndSortedProducts,deletingProductId,setNameFilter,handleMaxPriceChange,setSortOrder,handleProductAdded,handleDeleteProduct,fetchProducts};}export default useProductList;","map":{"version":3,"names":["useState","useEffect","useMemo","useCallback","axios","API_URL","useProductList","products","setProducts","loading","setLoading","error","setError","nameFilter","setNameFilter","maxPriceFilter","setMaxPriceFilter","sortOrder","setSortOrder","deletingProductId","setDeletingProductId","fetchProducts","response","get","concat","data","handleProductAdded","newProduct","prevProducts","handleDeleteProduct","productId","delete","filter","product","_id","_error$response","_error$response$data","message","handleMaxPriceChange","e","value","target","isNaN","parseFloat","isFinite","filteredAndSortedProducts","name","toLowerCase","includes","price","sort","a","b"],"sources":["C:/Users/sebas/boulangerie-app/frontend/src/hooks/useProductList.js"],"sourcesContent":["import { useState, useEffect, useMemo, useCallback } from 'react';\r\nimport axios from 'axios';\r\nimport { API_URL } from '../config';\r\n\r\nfunction useProductList() {\r\n  const [products, setProducts] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [nameFilter, setNameFilter] = useState('');\r\n  const [maxPriceFilter, setMaxPriceFilter] = useState('');\r\n  const [sortOrder, setSortOrder] = useState('');\r\n  const [deletingProductId, setDeletingProductId] = useState(null);\r\n\r\n  const fetchProducts = useCallback(async () => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await axios.get(`${API_URL}/products`);\r\n      setProducts(response.data);\r\n      setError(null);\r\n    } catch (error) {\r\n      setError(error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    fetchProducts();\r\n  }, [fetchProducts]);\r\n\r\n  const handleProductAdded = useCallback((newProduct) => {\r\n    setProducts(prevProducts => [...prevProducts, newProduct]);\r\n  }, []);\r\n\r\n  const handleDeleteProduct = async (productId) => {\r\n    try {\r\n      setDeletingProductId(productId);\r\n      await axios.delete(`${API_URL}/products/${productId}`);\r\n      setProducts(prevProducts => prevProducts.filter(product => product._id !== productId));\r\n    } catch (error) {\r\n      setError(`Erreur lors de la suppression : ${error.response?.data?.message || error.message}`);\r\n    } finally {\r\n      setDeletingProductId(null);\r\n    }\r\n  };\r\n\r\n  const handleMaxPriceChange = (e) => {\r\n    const value = e.target.value;\r\n    if (value === '' || (!isNaN(parseFloat(value)) && isFinite(value))) {\r\n      setMaxPriceFilter(value);\r\n    }\r\n  };\r\n\r\n  const filteredAndSortedProducts = useMemo(() => {\r\n    return products\r\n      .filter(product => product.name.toLowerCase().includes(nameFilter.toLowerCase()))\r\n      .filter(product => maxPriceFilter === '' || product.price <= parseFloat(maxPriceFilter))\r\n      .sort((a, b) => {\r\n        if (sortOrder === 'asc') {\r\n          return a.price - b.price;\r\n        } else if (sortOrder === 'desc') {\r\n          return b.price - a.price;\r\n        }\r\n        return 0;\r\n      });\r\n  }, [products, nameFilter, maxPriceFilter, sortOrder]);\r\n\r\n  return {\r\n    loading,\r\n    error,\r\n    nameFilter,\r\n    maxPriceFilter,\r\n    sortOrder,\r\n    filteredAndSortedProducts,\r\n    deletingProductId,\r\n    setNameFilter,\r\n    handleMaxPriceChange,\r\n    setSortOrder,\r\n    handleProductAdded,\r\n    handleDeleteProduct,\r\n    fetchProducts\r\n  };\r\n}\r\n\r\nexport default useProductList;\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}