{"ast":null,"code":"import{useState,useEffect,useMemo,useCallback}from'react';import axios from'axios';const API_URL='http://localhost:5000';function useProductList(){const[products,setProducts]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[nameFilter,setNameFilter]=useState('');const[maxPriceFilter,setMaxPriceFilter]=useState('');const[sortOrder,setSortOrder]=useState('');const[deletingProductId,setDeletingProductId]=useState(null);const fetchProducts=useCallback(async()=>{try{setLoading(true);console.log('Fetching products...');const response=await axios.get(\"\".concat(API_URL,\"/products\"));console.log('Products fetched:',response.data);setProducts(response.data);setError(null);}catch(error){console.error('Error fetching products:',error);setError('Une erreur est survenue lors de la récupération des produits.');}finally{setLoading(false);}},[]);useEffect(()=>{console.log('useEffect triggered, calling fetchProducts');fetchProducts();},[fetchProducts]);const handleProductAdded=useCallback(newProduct=>{console.log('Adding new product:',newProduct);setProducts(prevProducts=>[...prevProducts,newProduct]);},[]);const handleDeleteProduct=async productId=>{try{console.log(\"Attempting to delete product with ID: \".concat(productId));setDeletingProductId(productId);// Utilisation de setDeletingProductId\nawait axios.delete(\"\".concat(API_URL,\"/products/\").concat(productId));console.log(\"Product with ID: \".concat(productId,\" successfully deleted\"));setProducts(prevProducts=>prevProducts.filter(product=>product._id!==productId));}catch(error){var _error$response,_error$response2,_error$response2$data;console.error('Error deleting product:',((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.data)||error.message);setError(\"Erreur lors de la suppression : \".concat(((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||error.message));}finally{setDeletingProductId(null);// Réinitialisation de deletingProductId\n}};const handleMaxPriceChange=e=>{const value=e.target.value;if(value===''||!isNaN(parseFloat(value))&&isFinite(value)){console.log(\"Setting max price filter to: \".concat(value));setMaxPriceFilter(value);}};const filteredAndSortedProducts=useMemo(()=>{console.log('Recalculating filtered and sorted products');return products.filter(product=>product.name.toLowerCase().includes(nameFilter.toLowerCase())).filter(product=>maxPriceFilter===''||product.price<=parseFloat(maxPriceFilter)).sort((a,b)=>{if(sortOrder==='asc'){return a.price-b.price;}else if(sortOrder==='desc'){return b.price-a.price;}return 0;});},[products,nameFilter,maxPriceFilter,sortOrder]);console.log('Current state:',{productsCount:products.length,loading,error,nameFilter,maxPriceFilter,sortOrder,deletingProductId});return{loading,error,nameFilter,maxPriceFilter,sortOrder,filteredAndSortedProducts,deletingProductId,setNameFilter,handleMaxPriceChange,setSortOrder,handleProductAdded,handleDeleteProduct,fetchProducts};}export default useProductList;","map":{"version":3,"names":["useState","useEffect","useMemo","useCallback","axios","API_URL","useProductList","products","setProducts","loading","setLoading","error","setError","nameFilter","setNameFilter","maxPriceFilter","setMaxPriceFilter","sortOrder","setSortOrder","deletingProductId","setDeletingProductId","fetchProducts","console","log","response","get","concat","data","handleProductAdded","newProduct","prevProducts","handleDeleteProduct","productId","delete","filter","product","_id","_error$response","_error$response2","_error$response2$data","message","handleMaxPriceChange","e","value","target","isNaN","parseFloat","isFinite","filteredAndSortedProducts","name","toLowerCase","includes","price","sort","a","b","productsCount","length"],"sources":["C:/Users/sebas/boulangerie-app/frontend/src/hooks/useProductList.js"],"sourcesContent":["import { useState, useEffect, useMemo, useCallback } from 'react';\r\nimport axios from 'axios';\r\n\r\nconst API_URL = 'http://localhost:5000';\r\n\r\nfunction useProductList() {\r\n  const [products, setProducts] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [nameFilter, setNameFilter] = useState('');\r\n  const [maxPriceFilter, setMaxPriceFilter] = useState('');\r\n  const [sortOrder, setSortOrder] = useState('');\r\n  const [deletingProductId, setDeletingProductId] = useState(null);\r\n\r\n  const fetchProducts = useCallback(async () => {\r\n    try {\r\n      setLoading(true);\r\n      console.log('Fetching products...');\r\n      const response = await axios.get(`${API_URL}/products`);\r\n      console.log('Products fetched:', response.data);\r\n      setProducts(response.data);\r\n      setError(null);\r\n    } catch (error) {\r\n      console.error('Error fetching products:', error);\r\n      setError('Une erreur est survenue lors de la récupération des produits.');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    console.log('useEffect triggered, calling fetchProducts');\r\n    fetchProducts();\r\n  }, [fetchProducts]);\r\n\r\n  const handleProductAdded = useCallback((newProduct) => {\r\n    console.log('Adding new product:', newProduct);\r\n    setProducts(prevProducts => [...prevProducts, newProduct]);\r\n  }, []);\r\n\r\n  const handleDeleteProduct = async (productId) => {\r\n    try {\r\n      console.log(`Attempting to delete product with ID: ${productId}`);\r\n      setDeletingProductId(productId); // Utilisation de setDeletingProductId\r\n      await axios.delete(`${API_URL}/products/${productId}`);\r\n      console.log(`Product with ID: ${productId} successfully deleted`);\r\n      setProducts(prevProducts => prevProducts.filter(product => product._id !== productId));\r\n    } catch (error) {\r\n      console.error('Error deleting product:', error.response?.data || error.message);\r\n      setError(`Erreur lors de la suppression : ${error.response?.data?.message || error.message}`);\r\n    } finally {\r\n      setDeletingProductId(null); // Réinitialisation de deletingProductId\r\n    }\r\n  };\r\n\r\n  const handleMaxPriceChange = (e) => {\r\n    const value = e.target.value;\r\n    if (value === '' || (!isNaN(parseFloat(value)) && isFinite(value))) {\r\n      console.log(`Setting max price filter to: ${value}`);\r\n      setMaxPriceFilter(value);\r\n    }\r\n  };\r\n\r\n  const filteredAndSortedProducts = useMemo(() => {\r\n    console.log('Recalculating filtered and sorted products');\r\n    return products\r\n      .filter(product => product.name.toLowerCase().includes(nameFilter.toLowerCase()))\r\n      .filter(product => maxPriceFilter === '' || product.price <= parseFloat(maxPriceFilter))\r\n      .sort((a, b) => {\r\n        if (sortOrder === 'asc') {\r\n          return a.price - b.price;\r\n        } else if (sortOrder === 'desc') {\r\n          return b.price - a.price;\r\n        }\r\n        return 0;\r\n      });\r\n  }, [products, nameFilter, maxPriceFilter, sortOrder]);\r\n\r\n  console.log('Current state:', {\r\n    productsCount: products.length,\r\n    loading,\r\n    error,\r\n    nameFilter,\r\n    maxPriceFilter,\r\n    sortOrder,\r\n    deletingProductId\r\n  });\r\n\r\n  return {\r\n    loading,\r\n    error,\r\n    nameFilter,\r\n    maxPriceFilter,\r\n    sortOrder,\r\n    filteredAndSortedProducts,\r\n    deletingProductId,\r\n    setNameFilter,\r\n    handleMaxPriceChange,\r\n    setSortOrder,\r\n    handleProductAdded,\r\n    handleDeleteProduct,\r\n    fetchProducts\r\n  };\r\n}\r\n\r\nexport default useProductList;"],"mappings":"AAAA,OAASA,QAAQ,CAAEC,SAAS,CAAEC,OAAO,CAAEC,WAAW,KAAQ,OAAO,CACjE,MAAO,CAAAC,KAAK,KAAM,OAAO,CAEzB,KAAM,CAAAC,OAAO,CAAG,uBAAuB,CAEvC,QAAS,CAAAC,cAAcA,CAAA,CAAG,CACxB,KAAM,CAACC,QAAQ,CAAEC,WAAW,CAAC,CAAGR,QAAQ,CAAC,EAAE,CAAC,CAC5C,KAAM,CAACS,OAAO,CAAEC,UAAU,CAAC,CAAGV,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACW,KAAK,CAAEC,QAAQ,CAAC,CAAGZ,QAAQ,CAAC,IAAI,CAAC,CACxC,KAAM,CAACa,UAAU,CAAEC,aAAa,CAAC,CAAGd,QAAQ,CAAC,EAAE,CAAC,CAChD,KAAM,CAACe,cAAc,CAAEC,iBAAiB,CAAC,CAAGhB,QAAQ,CAAC,EAAE,CAAC,CACxD,KAAM,CAACiB,SAAS,CAAEC,YAAY,CAAC,CAAGlB,QAAQ,CAAC,EAAE,CAAC,CAC9C,KAAM,CAACmB,iBAAiB,CAAEC,oBAAoB,CAAC,CAAGpB,QAAQ,CAAC,IAAI,CAAC,CAEhE,KAAM,CAAAqB,aAAa,CAAGlB,WAAW,CAAC,SAAY,CAC5C,GAAI,CACFO,UAAU,CAAC,IAAI,CAAC,CAChBY,OAAO,CAACC,GAAG,CAAC,sBAAsB,CAAC,CACnC,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAApB,KAAK,CAACqB,GAAG,IAAAC,MAAA,CAAIrB,OAAO,aAAW,CAAC,CACvDiB,OAAO,CAACC,GAAG,CAAC,mBAAmB,CAAEC,QAAQ,CAACG,IAAI,CAAC,CAC/CnB,WAAW,CAACgB,QAAQ,CAACG,IAAI,CAAC,CAC1Bf,QAAQ,CAAC,IAAI,CAAC,CAChB,CAAE,MAAOD,KAAK,CAAE,CACdW,OAAO,CAACX,KAAK,CAAC,0BAA0B,CAAEA,KAAK,CAAC,CAChDC,QAAQ,CAAC,+DAA+D,CAAC,CAC3E,CAAC,OAAS,CACRF,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAAE,EAAE,CAAC,CAENT,SAAS,CAAC,IAAM,CACdqB,OAAO,CAACC,GAAG,CAAC,4CAA4C,CAAC,CACzDF,aAAa,CAAC,CAAC,CACjB,CAAC,CAAE,CAACA,aAAa,CAAC,CAAC,CAEnB,KAAM,CAAAO,kBAAkB,CAAGzB,WAAW,CAAE0B,UAAU,EAAK,CACrDP,OAAO,CAACC,GAAG,CAAC,qBAAqB,CAAEM,UAAU,CAAC,CAC9CrB,WAAW,CAACsB,YAAY,EAAI,CAAC,GAAGA,YAAY,CAAED,UAAU,CAAC,CAAC,CAC5D,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAE,mBAAmB,CAAG,KAAO,CAAAC,SAAS,EAAK,CAC/C,GAAI,CACFV,OAAO,CAACC,GAAG,0CAAAG,MAAA,CAA0CM,SAAS,CAAE,CAAC,CACjEZ,oBAAoB,CAACY,SAAS,CAAC,CAAE;AACjC,KAAM,CAAA5B,KAAK,CAAC6B,MAAM,IAAAP,MAAA,CAAIrB,OAAO,eAAAqB,MAAA,CAAaM,SAAS,CAAE,CAAC,CACtDV,OAAO,CAACC,GAAG,qBAAAG,MAAA,CAAqBM,SAAS,yBAAuB,CAAC,CACjExB,WAAW,CAACsB,YAAY,EAAIA,YAAY,CAACI,MAAM,CAACC,OAAO,EAAIA,OAAO,CAACC,GAAG,GAAKJ,SAAS,CAAC,CAAC,CACxF,CAAE,MAAOrB,KAAK,CAAE,KAAA0B,eAAA,CAAAC,gBAAA,CAAAC,qBAAA,CACdjB,OAAO,CAACX,KAAK,CAAC,yBAAyB,CAAE,EAAA0B,eAAA,CAAA1B,KAAK,CAACa,QAAQ,UAAAa,eAAA,iBAAdA,eAAA,CAAgBV,IAAI,GAAIhB,KAAK,CAAC6B,OAAO,CAAC,CAC/E5B,QAAQ,oCAAAc,MAAA,CAAoC,EAAAY,gBAAA,CAAA3B,KAAK,CAACa,QAAQ,UAAAc,gBAAA,kBAAAC,qBAAA,CAAdD,gBAAA,CAAgBX,IAAI,UAAAY,qBAAA,iBAApBA,qBAAA,CAAsBC,OAAO,GAAI7B,KAAK,CAAC6B,OAAO,CAAE,CAAC,CAC/F,CAAC,OAAS,CACRpB,oBAAoB,CAAC,IAAI,CAAC,CAAE;AAC9B,CACF,CAAC,CAED,KAAM,CAAAqB,oBAAoB,CAAIC,CAAC,EAAK,CAClC,KAAM,CAAAC,KAAK,CAAGD,CAAC,CAACE,MAAM,CAACD,KAAK,CAC5B,GAAIA,KAAK,GAAK,EAAE,EAAK,CAACE,KAAK,CAACC,UAAU,CAACH,KAAK,CAAC,CAAC,EAAII,QAAQ,CAACJ,KAAK,CAAE,CAAE,CAClErB,OAAO,CAACC,GAAG,iCAAAG,MAAA,CAAiCiB,KAAK,CAAE,CAAC,CACpD3B,iBAAiB,CAAC2B,KAAK,CAAC,CAC1B,CACF,CAAC,CAED,KAAM,CAAAK,yBAAyB,CAAG9C,OAAO,CAAC,IAAM,CAC9CoB,OAAO,CAACC,GAAG,CAAC,4CAA4C,CAAC,CACzD,MAAO,CAAAhB,QAAQ,CACZ2B,MAAM,CAACC,OAAO,EAAIA,OAAO,CAACc,IAAI,CAACC,WAAW,CAAC,CAAC,CAACC,QAAQ,CAACtC,UAAU,CAACqC,WAAW,CAAC,CAAC,CAAC,CAAC,CAChFhB,MAAM,CAACC,OAAO,EAAIpB,cAAc,GAAK,EAAE,EAAIoB,OAAO,CAACiB,KAAK,EAAIN,UAAU,CAAC/B,cAAc,CAAC,CAAC,CACvFsC,IAAI,CAAC,CAACC,CAAC,CAAEC,CAAC,GAAK,CACd,GAAItC,SAAS,GAAK,KAAK,CAAE,CACvB,MAAO,CAAAqC,CAAC,CAACF,KAAK,CAAGG,CAAC,CAACH,KAAK,CAC1B,CAAC,IAAM,IAAInC,SAAS,GAAK,MAAM,CAAE,CAC/B,MAAO,CAAAsC,CAAC,CAACH,KAAK,CAAGE,CAAC,CAACF,KAAK,CAC1B,CACA,MAAO,EAAC,CACV,CAAC,CAAC,CACN,CAAC,CAAE,CAAC7C,QAAQ,CAAEM,UAAU,CAAEE,cAAc,CAAEE,SAAS,CAAC,CAAC,CAErDK,OAAO,CAACC,GAAG,CAAC,gBAAgB,CAAE,CAC5BiC,aAAa,CAAEjD,QAAQ,CAACkD,MAAM,CAC9BhD,OAAO,CACPE,KAAK,CACLE,UAAU,CACVE,cAAc,CACdE,SAAS,CACTE,iBACF,CAAC,CAAC,CAEF,MAAO,CACLV,OAAO,CACPE,KAAK,CACLE,UAAU,CACVE,cAAc,CACdE,SAAS,CACT+B,yBAAyB,CACzB7B,iBAAiB,CACjBL,aAAa,CACb2B,oBAAoB,CACpBvB,YAAY,CACZU,kBAAkB,CAClBG,mBAAmB,CACnBV,aACF,CAAC,CACH,CAEA,cAAe,CAAAf,cAAc","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}