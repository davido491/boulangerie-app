{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect, useCallback, useMemo } from 'react';\nimport axios from 'axios';\nconst useProductList = () => {\n  _s();\n  const [products, setProducts] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [nameFilter, setNameFilter] = useState('');\n  const [maxPriceFilter, setMaxPriceFilter] = useState('');\n  const [sortOrder, setSortOrder] = useState('asc');\n  const [deletingProductId, setDeletingProductId] = useState(null);\n  const fetchProducts = useCallback(async () => {\n    setLoading(true);\n    setError(null);\n    try {\n      const response = await axios.get('http://localhost:50687/products');\n      const validatedProducts = response.data.map(product => ({\n        ...product,\n        costPrice: product.costPrice !== undefined ? product.costPrice : 0 // Assurer que costPrice est défini\n      }));\n      setProducts(validatedProducts);\n    } catch (err) {\n      setError('Erreur lors du chargement des produits');\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n  useEffect(() => {\n    fetchProducts();\n  }, [fetchProducts]);\n  const handleProductAdded = useCallback(newProduct => {\n    const validatedProduct = {\n      ...newProduct,\n      costPrice: newProduct.costPrice !== undefined ? newProduct.costPrice : 0 // Assurer que costPrice est défini\n    };\n    setProducts(prevProducts => [...prevProducts, validatedProduct]);\n  }, []);\n  const handleDeleteProduct = useCallback(async id => {\n    setDeletingProductId(id);\n    try {\n      console.log(`Suppression du produit avec l'ID : ${id}`);\n      const response = await axios.delete(`http://localhost:50687/products/${id}`);\n      console.log(`Réponse de l'API :`, response);\n      setProducts(prevProducts => prevProducts.filter(product => product.id !== id));\n    } catch (err) {\n      setError(`Erreur lors de la suppression du produit : ${err.message}`);\n      console.error('Erreur lors de la suppression du produit :', err);\n    } finally {\n      setDeletingProductId(null);\n    }\n  }, []);\n  const handleMaxPriceChange = useCallback(e => {\n    setMaxPriceFilter(e.target.value);\n  }, []);\n  const filteredAndSortedProducts = useMemo(() => {\n    return products.filter(product => product.name.toLowerCase().includes(nameFilter.toLowerCase()) && (maxPriceFilter === '' || product.price <= parseFloat(maxPriceFilter))).sort((a, b) => sortOrder === 'asc' ? a.price - b.price : b.price - a.price);\n  }, [products, nameFilter, maxPriceFilter, sortOrder]);\n  return {\n    loading,\n    error,\n    nameFilter,\n    maxPriceFilter,\n    sortOrder,\n    filteredAndSortedProducts,\n    deletingProductId,\n    setNameFilter,\n    handleMaxPriceChange,\n    setSortOrder,\n    handleProductAdded,\n    handleDeleteProduct,\n    fetchProducts\n  };\n};\n_s(useProductList, \"uUZPQRed0VAlKB8t9lk+9WUuaDM=\");\nexport default useProductList;","map":{"version":3,"names":["useState","useEffect","useCallback","useMemo","axios","useProductList","_s","products","setProducts","loading","setLoading","error","setError","nameFilter","setNameFilter","maxPriceFilter","setMaxPriceFilter","sortOrder","setSortOrder","deletingProductId","setDeletingProductId","fetchProducts","response","get","validatedProducts","data","map","product","costPrice","undefined","err","handleProductAdded","newProduct","validatedProduct","prevProducts","handleDeleteProduct","id","console","log","delete","filter","message","handleMaxPriceChange","e","target","value","filteredAndSortedProducts","name","toLowerCase","includes","price","parseFloat","sort","a","b"],"sources":["C:/Users/sebas/boulangerie-app/frontend/src/hooks/useProductList.js"],"sourcesContent":["import { useState, useEffect, useCallback, useMemo } from 'react';\r\nimport axios from 'axios';\r\n\r\nconst useProductList = () => {\r\n  const [products, setProducts] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [nameFilter, setNameFilter] = useState('');\r\n  const [maxPriceFilter, setMaxPriceFilter] = useState('');\r\n  const [sortOrder, setSortOrder] = useState('asc');\r\n  const [deletingProductId, setDeletingProductId] = useState(null);\r\n\r\n  const fetchProducts = useCallback(async () => {\r\n    setLoading(true);\r\n    setError(null);\r\n    try {\r\n      const response = await axios.get('http://localhost:50687/products');\r\n      const validatedProducts = response.data.map(product => ({\r\n        ...product,\r\n        costPrice: product.costPrice !== undefined ? product.costPrice : 0, // Assurer que costPrice est défini\r\n      }));\r\n      setProducts(validatedProducts);\r\n    } catch (err) {\r\n      setError('Erreur lors du chargement des produits');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    fetchProducts();\r\n  }, [fetchProducts]);\r\n\r\n  const handleProductAdded = useCallback((newProduct) => {\r\n    const validatedProduct = {\r\n      ...newProduct,\r\n      costPrice: newProduct.costPrice !== undefined ? newProduct.costPrice : 0, // Assurer que costPrice est défini\r\n    };\r\n    setProducts((prevProducts) => [...prevProducts, validatedProduct]);\r\n  }, []);\r\n\r\n  const handleDeleteProduct = useCallback(async (id) => {\r\n    setDeletingProductId(id);\r\n    try {\r\n      console.log(`Suppression du produit avec l'ID : ${id}`);\r\n      const response = await axios.delete(`http://localhost:50687/products/${id}`);\r\n      console.log(`Réponse de l'API :`, response);\r\n      setProducts((prevProducts) => prevProducts.filter(product => product.id !== id));\r\n    } catch (err) {\r\n      setError(`Erreur lors de la suppression du produit : ${err.message}`);\r\n      console.error('Erreur lors de la suppression du produit :', err);\r\n    } finally {\r\n      setDeletingProductId(null);\r\n    }\r\n  }, []);\r\n\r\n  const handleMaxPriceChange = useCallback((e) => {\r\n    setMaxPriceFilter(e.target.value);\r\n  }, []);\r\n\r\n  const filteredAndSortedProducts = useMemo(() => {\r\n    return products\r\n      .filter(product => \r\n        product.name.toLowerCase().includes(nameFilter.toLowerCase()) && \r\n        (maxPriceFilter === '' || product.price <= parseFloat(maxPriceFilter))\r\n      )\r\n      .sort((a, b) => (sortOrder === 'asc' ? a.price - b.price : b.price - a.price));\r\n  }, [products, nameFilter, maxPriceFilter, sortOrder]);\r\n\r\n  return {\r\n    loading,\r\n    error,\r\n    nameFilter,\r\n    maxPriceFilter,\r\n    sortOrder,\r\n    filteredAndSortedProducts,\r\n    deletingProductId,\r\n    setNameFilter,\r\n    handleMaxPriceChange,\r\n    setSortOrder,\r\n    handleProductAdded,\r\n    handleDeleteProduct,\r\n    fetchProducts\r\n  };\r\n};\r\n\r\nexport default useProductList;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}